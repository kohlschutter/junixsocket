<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0-M13 from src/site/markdown/building.md at 2023-10-27
 | Rendered using Apache Maven Fluido Skin 2.0.0-M8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0-M13" />
    <title>junixsocket – Building from source</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.0.0-M8.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.0.0-M8.min.js"></script>
  </head>
  <body>
    <a class="github-fork-ribbon right-top" href="https://github.com/kohlschutter/junixsocket" data-ribbon="Fork me on GitHub">Fork me on GitHub</a>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1>junixsocket — Unix Domain Sockets for Java</h1></div></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2023-10-27<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.8.2</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="index.html">Welcome</a></li>
    <li><a href="changelog.html">New &amp; Noteworthy</a></li>
    <li><a href="quickstart.html">Quick Start</a></li>
    <li class="active"><a>Building</a></li>
    <li><a href="compatibility.html">Compatibility</a></li>
    <li><a href="selftest.html">Selftest</a></li>
    <li><a href="dependency.html">Add junixsocket to your project</a></li>
   <li class="nav-header">Reference</li>
    <li><a href="apidocs/index.html">API Javadoc</a></li>
    <li><a href="xref/index.html">Source xref</a></li>
    <li><a href="xref-test/index.html">Test xref</a></li>
    <li><a href="junixsocket-codecoverage/jacoco-aggregate/index.html">Code Coverage</a></li>
   <li class="nav-header">Protocols</li>
    <li><a href="junixsocket-tipc/index.html">AF_TIPC</a></li>
    <li><a href="quickstart.html">AF_UNIX</a></li>
    <li><a href="junixsocket-vsock/index.html">AF_VSOCK</a></li>
    <li><a href="junixsocket-darwin/index.html">AF_SYSTEM</a></li>
   <li class="nav-header">Demo Code</li>
    <li><a href="demo.html">Command line demos</a></li>
    <li><a href="junixsocket-demo/xref/index.html">Source reference</a></li>
    <li><a href="filedescriptors.html">File descriptors</a></li>
    <li><a href="peercreds.html">Peer credentials</a></li>
    <li><a href="http.html">HTTP over Unix sockets</a></li>
   <li class="nav-header">For Developers</li>
    <li><a href="development.html">Developing junixsocket</a></li>
    <li><a href="unixsockets.html">Unix Sockets Reference</a></li>
    <li><a href="customarch.html">Custom architectures</a></li>
    <li><a href="crosscomp.html">Cross-Compiling with crossclang</a></li>
    <li><a href="eclipse.html">Developing with Eclipse</a></li>
    <li><a href="release.html">Release Instructions</a></li>
   <li class="nav-header">Modules</li>
    <li><a href="junixsocket-common/index.html">junixsocket-common</a></li>
    <li><a href="junixsocket-tipc/index.html">junixsocket-tipc</a></li>
    <li><a href="junixsocket-vsock/index.html">junixsocket-vsock</a></li>
    <li><a href="junixsocket-darwin/index.html">junixsocket-darwin</a></li>
    <li><a href="junixsocket-server/index.html">junixsocket-server</a></li>
    <li><a href="junixsocket-ssl/index.html">junixsocket-ssl</a></li>
    <li><a href="junixsocket-rmi/index.html">junixsocket-rmi</a></li>
    <li><a href="junixsocket-mysql/index.html">junixsocket-mysql</a></li>
    <li><a href="junixsocket-core/index.html">junixsocket-core</a></li>
    <li><a href="junixsocket-demo/index.html">junixsocket-demo</a></li>
    <li><a href="junixsocket-dist/index.html">junixsocket-dist</a></li>
    <li><a href="junixsocket-codecoverage/index.html">junixsocket-codecoverage</a></li>
    <li><a href="junixsocket-native-custom/index.html">junixsocket-native-custom</a></li>
    <li><a href="junixsocket-native-android/index.html">junixsocket-native-android</a></li>
    <li><a href="junixsocket-jetty/index.html">junixsocket-jetty</a></li>
    <li><a href="junixsocket-jetty-12/index.html">junixsocket-jetty</a></li>
    <li><a href="junixsocket-selftest/index.html">junixsocket-selftest</a></li>
    <li><a href="junixsocket-selftest-native-image/index.html">junixsocket-selftest-native-image</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">
<section>
<h1>Building from source</h1>
<p>Here's how you build junixsocket from the source.</p><section>
<h2>Prerequisites</h2>
<ol style="list-style-type: decimal;">

<li>
<p>Make sure you have a 64-bit machine running macOS or Linux.</p>
<p>If you have a different platform or architecture, <a href="customarch.html">continue here</a>.</p></li>
<li>
<p>Install the Java JDK 17 or newer, Maven 3.8.8 or newer, and junixsocket.</p>
<p>Even though junixsocket can run on Java 8 (and even on Java 7 for the common part), you need Java 17 or better to build it, so we can
support the new Java module system on newer Java versions as well as features that are only
available on newer versions (e.g., UnixDomainSocketAddress).</p></li>
<li>
<p>Install a development environment so you can compile C code (preferably clang/llvm).</p>
<p>On macOS, this means installing Xcode.
For development purposes, you may want to use the Xcode project defined in <code>junixsocket-native/junixsocket-native.xcodeproj</code>.
However, this is not required. Running Maven (see below) is the authoritative way of building the native code.</p>
<p>Also see <a href="crosscomp.html">here</a> for instructions how to cross-compile for all supported architectures.</p>
<p>Be sure to install <code>bash</code>, <code>gcc</code>,<code>clang</code>, <code>ld</code>/<code>binutils</code>, C headers (<code>glibc-devel</code>/<code>libc-dev</code>, <code>musl-dev</code>, etc.), and, optionally, for TIPC on Linux, Linux headers (e.g, <code>linux-headers</code>).</p>
<p>For example, on Alpine Linux, run the following command:</p>

<div class="verbatim">
<pre><code>sudo apk add git maven clang gcc binutils bash musl-dev libc-dev linux-headers
</code></pre></div></li>
<li>
<p>Install the Java JDK 8 as well (or exclude a config when building; see below)</p>
<p>Since version 2.8.0, we support Java 7 again. This works through a plugin called &#x201c;retrolambda&#x201d;,
which translates Java 8 bytecode in a way that it works on Java 7 again. This plugin stopped
working with newer Java versions, so we need to run Java 8 in a forked process.</p>
<p>In order for the plugin to find the Java 8 installation, make sure that you have a <code>$HOME/.m2/toolchains.xml</code> file
with at least the following configuration:</p>

<div class="verbatim">
<pre><code> &lt;toolchains&gt;
   &lt;toolchain&gt;
     &lt;type&gt;jdk&lt;/type&gt;
     &lt;provides&gt;
       &lt;version&gt;1.8&lt;/version&gt;
     &lt;/provides&gt;
     &lt;configuration&gt;
       &lt;jdkHome&gt;/Library/Java/JavaVirtualMachines/1.8.0.jdk/Contents/Home/&lt;/jdkHome&gt;
     &lt;/configuration&gt;
   &lt;/toolchain&gt;
 &lt;/toolchains&gt;
</code></pre></div>
<p>Replace the path at <code>jdkHome</code> with your system's configuration. For the purposes of building
junixsocket, you can have a version <code>1.8</code> or <code>8</code>; both will work.</p>
<p>If you cannot/do not want to install JDK 8, add the following parameter to the <code>mvn</code>
command below: <code>-Dretrolambda=false</code>.</p></li>
</ol></section><section>
<h2>Building with Maven</h2>
<p>Build and test junixsocket.</p>

<div class="verbatim">
<pre><code>cd junixsocket
mvn clean install
# or:
# mvn clean install -Dretrolambda=false
</code></pre></div>
<p>That's it!</p><section>
<h3>SNAPSHOT builds</h3>
<p>Development versions may need SNAPSHOT versions of dependencies. Use the following command to build:</p>

<div class="verbatim">
<pre><code>mvn clean install -Duse-snapshots
</code></pre></div></section></section><section>
<h2>Build options</h2>
<p>While the default build options are a good start, you may want to change the level of scrutiny performed at build time.</p>
<p>Here's how to make building stricter (more potential errors are found):</p>

<div class="verbatim">
<pre><code>mvn clean install -Dstrict
</code></pre></div>
<p>Here's how to make building less strict (this turns off several code quality checkers but will dramatically shorten build times):</p>

<div class="verbatim">
<pre><code>mvn clean install -Dignorant
</code></pre></div>
<p>If some tests fail, you may try</p>

<div class="verbatim">
<pre><code>mvn clean install -DskipTests
</code></pre></div>
<p>If you're having problems with building the native library, you can skip directly to building the Java code via</p>

<div class="verbatim">
<pre><code>mvn clean install -rf :junixsocket-common
</code></pre></div>
<p>You can also try to build the full release version of junixsocket (which will include all cross-compile destinations) &#x2013; see the <a href="release.html">release instructions</a> for details:</p>

<div class="verbatim">
<pre><code>mvn clean install -Dstrict -Drelease
</code></pre></div></section><section>
<h2>Issues and Workarounds</h2><section>
<h3>clang/gcc</h3>
<p>If you don't have clang, try compiling with gcc. You may need to specify the compiler/linker at the command line:</p>

<div class="verbatim">
<pre><code>mvn clean install -Djunixsocket.native.default.linkerName=gcc
</code></pre></div></section><section>
<h3>Failure to find com.kohlschutter.junixsocket:junixsocket-native-custom:jar:default:&#x2026;-SNAPSHOT</h3>
<p>You're building a SNAPSHOT version, skipping over native artifacts, and access to some native
artifacts is missing. Try building with the &#x201c;use-snapshot&#x201d; config first:</p>

<div class="verbatim">
<pre><code>mvn clean install -Duse-snapshot -rf :junixsocket-native-custom
</code></pre></div>
<p>If that doesn't work, try ignoring junixsocket-native-custom as an optional dependency for testing:</p>

<div class="verbatim">
<pre><code>mvn clean install -Dnative-custom.skip -rf :junixsocket-common
</code></pre></div></section></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
<p id="giscus-parent" style="margin-top:20pt;padding-top:20pt;border-top:thin solid #bbb;">
        <script src="https://giscus.app/client.js"
          data-repo="kohlschutter/junixsocket"
          data-repo-id="MDEwOlJlcG9zaXRvcnkyNzA2NDIwMQ=="
          data-category="Giscus"
          data-category-id="DIC_kwDOAZz3ic4CQT9j"
          data-mapping="pathname"
          data-reactions-enabled="1"
          data-emit-metadata="0"
          data-input-position="bottom"
          data-theme="light"
          data-lang="en"
          data-loading="lazy"
          crossorigin="anonymous"
          async="async">
        </script>
        <small>
          Discussions widget provided by giscus.app —
          <a
            href="https://github.com/giscus/giscus/blob/main/PRIVACY-POLICY.md"
            target="_top">
            giscus.app privacy policy
          </a> —
          <a href="https://docs.github.com/en/site-policy/github-terms/github-community-guidelines">
          GitHub Community Guidelines
          </a>
        </small>
      </p>
      <script><!--
      document.addEventListener("DOMContentLoaded", function(event) {
        document.getElementById("bodyColumn").appendChild(document.getElementById("giscus-parent"));
      });
      // --></script>
      <p>Copyright 2009–2022
         <a href="https://www.kohlschutter.com/">Kohlschütter Search Intelligence</a>
      </p>
        </div>
      </div>
    </footer>
<script>
  if(anchors) {
    anchors.add();
  }
</script>
  </body>
</html>